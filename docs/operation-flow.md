# 操作フロー

このドキュメントでは、Miro-Redmine Integrationを使用した基本的な操作フローについて説明します。このツールを使って、RedmineチケットとMiroボードを効率的に連携させる方法を学びましょう。

## 準備

操作を始める前に、以下の準備が完了していることを確認してください：

1. [installation.md](installation.md)の手順に従ってツールがインストールされていること
2. [board-setup.md](board-setup.md)の手順に従ってMiroボードが設定されていること
3. 連携するRedmineプロジェクトが正しく設定されていること

## システム連携フロー図

以下の図は、Miro-Redmine Integrationの基本的な連携フローを示しています：

![Miro-Redmine基本連携フロー](images/miro-redmine-flow-diagram.png)

### 双方向同期の仕組み

1. **Redmineからの更新**:
   - Redmineチケットが更新されると、ウェブフックがトリガーされます
   - 統合サーバーがウェブフックを受け取り、対応するMiroカードを更新します
   - 変更がMiroボード上に反映されます

2. **Miroからの更新**:
   - Miroボード上のカードが移動/編集されると、ウェブフックがトリガーされます
   - 統合サーバーがウェブフックを受け取り、対応するRedmineチケットを更新します
   - 変更がRedmine上に反映されます

## 基本的な操作フロー

### 1. 初期同期

ツールを初めて使用する場合、まずはRedmineのチケットをMiroボードに同期させる必要があります：

1. Miro-Redmine Integration管理画面（`http://localhost:3000`）にアクセスします。
2. 「同期」タブをクリックします。
3. 「初期同期」ボタンをクリックします。
4. 進捗バーが表示され、同期の状況が表示されます。
5. 同期が完了すると、Miroボードに全てのアクティブなRedmineチケットが表示されます。

### 2. Redmineチケットの更新とMiroボードへの反映

Redmineでチケットを更新すると、自動的にMiroボードに反映されます：

1. Redmineにログインし、対象のプロジェクトを開きます。
2. チケットを更新します（例：ステータスの変更、担当者の変更、コメントの追加など）。
3. 同期設定に応じて、変更は自動的にMiroボードに反映されます：
   * 「リアルタイム同期」を有効にしている場合: 数秒〜1分以内に反映されます
   * 「定期同期」を有効にしている場合: 設定された間隔（デフォルトは5分）で反映されます
   * どちらも無効の場合: 管理画面から「手動同期」を実行する必要があります

### 3. Miroボード上でのチケット操作

Miroボード上でもチケットを操作でき、その変更はRedmineに反映されます：

#### チケット移動（ステータス変更）

1. Miroボードで対象のチケットカードを選択します。
2. カードを別のカラム（ステータス）にドラッグ＆ドロップします。
3. 確認ダイアログが表示されたら「はい」をクリックします。
4. 数秒後、Redmineでそのチケットのステータスが変更されます。

#### チケット編集

1. Miroボードで対象のチケットカードをダブルクリックします。
2. 編集可能なフィールドが表示されたダイアログが開きます。
3. 必要な情報を編集します（件名、説明、優先度など）。
4. 「保存」ボタンをクリックします。
5. 変更がRedmineに反映されます。

#### コメント追加

1. Miroボードで対象のチケットカードを右クリックします。
2. コンテキストメニューから「コメント追加」を選択します。
3. コメント入力ダイアログが表示されるので、コメントを入力します。
4. 「送信」ボタンをクリックします。
5. コメントがRedmineのチケットに追加されます。

### 4. 新規チケット作成

Miroボードから直接新規チケットを作成することもできます：

1. Miroボードのツールバーから「Redmineチケット作成」ボタンをクリックします。
2. チケット作成フォームが表示されます。
3. 必要な情報を入力します：
   * タイトル（必須）
   * 説明
   * 優先度
   * 担当者
   * 期日
   * その他のカスタムフィールド
4. 「作成」ボタンをクリックします。
5. 新しいチケットがRedmineに作成され、同時にMiroボードに追加されます。
6. ボード上で適切な位置（ステータスに応じたカラム）に配置されます。

### 5. フィルタリングと検索

Miroボード上のチケットをフィルタリングして、必要な情報だけを表示することができます：

1. Miroボードのツールバーから「フィルター」ボタンをクリックします。
2. フィルター条件を設定します：
   * ステータス（複数選択可）
   * 優先度（複数選択可）
   * 担当者（複数選択可）
   * トラッカー（バグ、タスク、機能など）
   * キーワード検索
3. 「適用」ボタンをクリックします。
4. 条件に合致するチケットだけが表示されます。
5. フィルターをクリアするには「リセット」ボタンをクリックします。

### 6. ボードのリフレッシュ

最新の状態に更新したい場合や、同期エラーが発生した場合は、手動でボードをリフレッシュできます：

1. Miroボードのツールバーから「リフレッシュ」ボタンをクリックします。
2. または管理画面の「同期」タブから「強制再同期」ボタンをクリックします。
3. 全てのチケットが最新の状態に更新されます。

## 実例：スプリント計画から実行までのワークフロー

以下は、Miro-Redmine Integrationを使用したスクラム/アジャイル開発の一般的なワークフローの例です：

### スプリント計画（Sprint Planning）

1. Miroボードを開き、「バックログ」カラムにあるチケットを確認します。
2. チームミーティングで各チケットを議論し、優先順位や見積もりを決定します。
3. Miroボード上で、スプリントに含めるチケットを「ToDo」カラムにドラッグします。
   * この操作によって、Redmineのチケットステータスが自動的に更新されます。
4. 必要に応じて、チケットをクリックして詳細を編集します（見積時間、担当者など）。

### デイリースクラム（Daily Scrum）

1. 毎日のミーティングでMiroボードを開き、現在の状況を確認します。
2. 各メンバーが担当しているチケットの状況を更新します：
   * 進行中のタスクは「進行中」カラムに移動
   * 完了したタスクは「レビュー」または「完了」カラムに移動
3. 障害やブロッカーがある場合は、チケットにコメントを追加するか、赤いフラグでマークします。

### スプリントレビュー＆スプリント終了

1. スプリント終了時に、Miroボード上で完了したチケットを確認します。
2. 「完了」カラムにあるチケットを確認し、全てのタスクが適切に完了しているか検証します。
3. 未完了のチケットは、次のスプリントに移動するか、バックログに戻します。
4. スプリントの振り返り（レトロスペクティブ）には、Miroの他の機能（付箋、投票など）も活用できます。

## 実例：チーム別ユースケースシナリオ

### 小規模開発チーム（5人以下）のワークフロー

**チーム構成:**
- プロジェクトマネージャー1名
- 開発者3名
- デザイナー1名

**ワークフロー例:**

1. **月曜日：スプリント計画**
   - チーム全員がMiroボードを開きます
   - PMがバックログからチケットを「ToDo」列に移動し、優先順位を決定します
   - 開発者が各チケットを選択し、担当者に自分を割り当てます
   - カードの色は優先度で色分けされています（赤=高、黄=中、緑=低）

   ![小規模チームスプリント計画](images/small-team-sprint-planning.png)

2. **毎日：デイリースタンドアップ**
   - 10分間のビデオ会議でMiroボードを確認します
   - 各メンバーが担当チケットの進捗を共有し、必要に応じてカードを移動します
   - ブロッカーがある場合は、カードに赤いフラグを付けます

3. **金曜日：週次レビュー**
   - 完成したタスクを「レビュー」から「完了」に移動します
   - 次週に持ち越すタスクについて議論します
   - ボード上で次週の予定を視覚的に整理します
